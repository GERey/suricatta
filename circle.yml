version: 2
jobs:
  build:
    executorType: docker
    containerInfo:
      - image: clojure:lein-2.7.1
      - image: postgres:9.3-alpine
        env:
          - POSTGRES_USER=root
          - POSTGRES_DB=test
          
    workDir: ~/suricatta
    steps:
      - type: checkout

      - type: cache-restore
        key: v1-jars-{{ checksum "project.clj" }}
        
      - type: shell
        command: lein test-all

      - type: cache-save
        key: v1-jars-{{ checksum "project.clj" }}
        paths:
          - ~/.m2

